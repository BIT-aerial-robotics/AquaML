# AquaML æ¡†æ¶æ¶æ„æ–‡æ¡£

## æ¦‚è¿°

AquaMLæ˜¯ä¸€ä¸ªæ¨¡å—åŒ–çš„å¼ºåŒ–å­¦ä¹ æ¡†æ¶ï¼Œä¸“é—¨ä¸ºæœºå™¨äººå­¦ä¹ ä»»åŠ¡è®¾è®¡ã€‚æ¡†æ¶åç§°å¯“æ„"åƒæ°´ä¸€æ ·é€‚åº”å„ç§ç¯å¢ƒ"ï¼Œé‡‡ç”¨å­—å…¸å¼æ•°æ®ç»“æ„å’Œåè°ƒå™¨æ¨¡å¼ï¼Œæä¾›ç»Ÿä¸€çš„ç»„ä»¶ç®¡ç†å’Œè®¾å¤‡ç®¡ç†èƒ½åŠ›ã€‚

## æ¶æ„å›¾

```
AquaML å¼ºåŒ–å­¦ä¹ æ¡†æ¶æ¶æ„å›¾

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    AquaML Framework                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                            Core - åè°ƒå™¨ç³»ç»Ÿ                                        â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚   Coordinator   â”‚  â”‚   Device Info   â”‚  â”‚   Registry      â”‚  â”‚   Tensor Tool   â”‚  â”‚â”‚
â”‚  â”‚  â”‚   å…¨å±€åè°ƒå™¨     â”‚  â”‚   è®¾å¤‡ç®¡ç†       â”‚  â”‚   ç»„ä»¶æ³¨å†Œ       â”‚  â”‚   å¼ é‡å·¥å…·       â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â”‚                                                                                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚  â”‚                           Managers - ç®¡ç†å™¨ç³»ç»Ÿ                                  â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”‚Agent Managerâ”‚ â”‚Model Managerâ”‚ â”‚Environment  â”‚ â”‚Data Manager â”‚ â”‚File System  â”‚ â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”‚æ™ºèƒ½ä½“ç®¡ç†    â”‚ â”‚æ¨¡å‹ç®¡ç†      â”‚ â”‚Manager      â”‚ â”‚æ•°æ®ç®¡ç†      â”‚ â”‚Manager      â”‚ â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”‚             â”‚ â”‚             â”‚ â”‚ç¯å¢ƒç®¡ç†      â”‚ â”‚             â”‚ â”‚æ–‡ä»¶ç³»ç»Ÿç®¡ç†  â”‚ â”‚â”‚â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚â”‚
â”‚  â”‚  â”‚                                                                                 â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”‚Communicator â”‚ â”‚Data Unit    â”‚ â”‚Runner       â”‚ â”‚   Plugin    â”‚                â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”‚Manager      â”‚ â”‚Manager      â”‚ â”‚Manager      â”‚ â”‚   System    â”‚                â”‚â”‚â”‚
â”‚  â”‚  â”‚ â”‚é€šä¿¡ç®¡ç†      â”‚ â”‚æ•°æ®å•å…ƒç®¡ç†  â”‚ â”‚è¿è¡Œå™¨ç®¡ç†    â”‚ â”‚   æ’ä»¶ç³»ç»Ÿ   â”‚                â”‚â”‚â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                          Environment - ç¯å¢ƒç³»ç»Ÿ                                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚  â”‚   Base Env      â”‚  â”‚                  Wrappers - ç¯å¢ƒåŒ…è£…å™¨                      â”‚â”‚â”‚
â”‚  â”‚  â”‚   ç¯å¢ƒåŸºç±»       â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚  â”‚ Gymnasium   â”‚ â”‚ Isaac Lab   â”‚ â”‚    Brax     â”‚ â”‚ Pettingâ”‚ â”‚â”‚â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚  â”‚ Wrapper     â”‚ â”‚ Wrapper     â”‚ â”‚  Wrapper    â”‚ â”‚  Zoo   â”‚ â”‚â”‚â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚ Wrapperâ”‚ â”‚â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚â”‚
â”‚  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                          Learning - å­¦ä¹ ç³»ç»Ÿ                                        â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚  â”‚                           Model - æ¨¡å‹ç³»ç»Ÿ                                      â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚   Base Model    â”‚  â”‚  Gaussian Model â”‚  â”‚   Model Config  â”‚                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚   æ¨¡å‹åŸºç±»       â”‚  â”‚  é«˜æ–¯æ¨¡å‹        â”‚  â”‚   æ¨¡å‹é…ç½®       â”‚                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚                                                                                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚  â”‚                     Reinforcement - å¼ºåŒ–å­¦ä¹ ç®—æ³•                                â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚   Base Agent    â”‚  â”‚   On-Policy     â”‚  â”‚   Off-Policy    â”‚                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚   æ™ºèƒ½ä½“åŸºç±»     â”‚  â”‚   åœ¨ç­–ç•¥ç®—æ³•     â”‚  â”‚   ç¦»ç­–ç•¥ç®—æ³•     â”‚                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚                                                                                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚  â”‚                        Trainers - è®­ç»ƒå™¨ç³»ç»Ÿ                                    â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚  Base Trainer   â”‚  â”‚Sequential Trainerâ”‚  â”‚  Trainer Config â”‚                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚  è®­ç»ƒå™¨åŸºç±»      â”‚  â”‚  é¡ºåºè®­ç»ƒå™¨      â”‚  â”‚  è®­ç»ƒå™¨é…ç½®      â”‚                  â”‚â”‚â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                          Data - æ•°æ®å¤„ç†ç³»ç»Ÿ                                        â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚   Base Unit     â”‚  â”‚   Tensor Unit   â”‚  â”‚   NumPy Unit    â”‚  â”‚   Config Status â”‚  â”‚â”‚
â”‚  â”‚  â”‚   æ•°æ®å•å…ƒåŸºç±»   â”‚  â”‚   å¼ é‡æ•°æ®å•å…ƒ   â”‚  â”‚   NumPyæ•°æ®å•å…ƒ  â”‚  â”‚   é…ç½®çŠ¶æ€       â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                          Config - é…ç½®ç³»ç»Ÿ                                          â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚  Config Class   â”‚  â”‚ Config Manager  â”‚  â”‚   Defaults      â”‚  â”‚    Schemas      â”‚  â”‚â”‚
â”‚  â”‚  â”‚  é…ç½®ç±»è£…é¥°å™¨    â”‚  â”‚  é…ç½®ç®¡ç†å™¨      â”‚  â”‚   é»˜è®¤é…ç½®       â”‚  â”‚    é…ç½®æ¶æ„      â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                          Utils - å·¥å…·æ¨¡å—                                           â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚ Preprocessors   â”‚  â”‚   Schedulers    â”‚  â”‚  TensorBoard    â”‚  â”‚  File System    â”‚  â”‚â”‚
â”‚  â”‚  â”‚ é¢„å¤„ç†å™¨         â”‚  â”‚   è°ƒåº¦å™¨        â”‚  â”‚  Manager        â”‚  â”‚  æ–‡ä»¶ç³»ç»Ÿå·¥å…·    â”‚  â”‚â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚  TensorBoardç®¡ç† â”‚  â”‚                 â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•°æ®æµå‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¯å¢ƒ       â”‚â”€â”€â”€â–¶â”‚   ç¯å¢ƒåŒ…è£…å™¨     â”‚â”€â”€â”€â–¶â”‚   æ•°æ®é¢„å¤„ç†     â”‚â”€â”€â”€â–¶â”‚   æ™ºèƒ½ä½“        â”‚
â”‚ Environment â”‚    â”‚   Wrappers      â”‚    â”‚  Preprocessors  â”‚    â”‚   Agent         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–²                                                                   â”‚
       â”‚                                                                   â–¼
       â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚           â”‚   æ¨¡å‹ç®¡ç†å™¨     â”‚â—€â”€â”€â”€â”‚   è®­ç»ƒå™¨        â”‚â—€â”€â”€â”€â”‚   å­¦ä¹ ç®—æ³•      â”‚
       â”‚           â”‚ Model Manager   â”‚    â”‚   Trainer       â”‚    â”‚  RL Algorithm   â”‚
       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â–²                       â”‚
       â”‚                    â”‚                       â–¼
       â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   åè°ƒå™¨        â”‚â—€â”€â”€â”€â”‚   æ•°æ®ç®¡ç†å™¨     â”‚
                   â”‚  Coordinator    â”‚    â”‚  Data Manager   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. åè°ƒå™¨ç³»ç»Ÿ (Core)

åè°ƒå™¨ç³»ç»Ÿæ˜¯AquaMLçš„æ ¸å¿ƒæ§åˆ¶å±‚ï¼Œè´Ÿè´£å…¨å±€èµ„æºç®¡ç†å’Œç»„ä»¶åè°ƒã€‚

#### ä¸»è¦ç»„ä»¶ï¼š
- **coordinator.py** (`/AquaML/core/coordinator.py`): ä¸»åè°ƒå™¨ï¼Œå…¨å±€è®¾å¤‡ç®¡ç†å’Œæ—¥å¿—é…ç½®
- **device_info.py** (`/AquaML/core/device_info.py`): GPUè®¾å¤‡æ£€æµ‹å’Œæœ€ä¼˜è®¾å¤‡é€‰æ‹©
- **registry.py** (`/AquaML/core/registry.py`): ç»„ä»¶æ³¨å†Œå’Œç®¡ç†
- **tensor_tool.py** (`/AquaML/core/tensor_tool.py`): å¼ é‡æ“ä½œå·¥å…·

#### ç®¡ç†å™¨æ¨¡å— (Managers):
- **agent_manager.py**: æ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **model_manager.py**: æ¨¡å‹ä¿å­˜ã€åŠ è½½å’Œç‰ˆæœ¬æ§åˆ¶
- **environment_manager.py**: ç¯å¢ƒå®ä¾‹ç®¡ç†å’Œèµ„æºåˆ†é…
- **data_manager.py**: æ•°æ®æ”¶é›†å’Œæ‰¹å¤„ç†ç®¡ç†
- **file_system_manager.py**: æ–‡ä»¶ç³»ç»Ÿæ“ä½œå’Œå®éªŒç®¡ç†
- **communicator_manager.py**: é€šä¿¡ç®¡ç†å™¨
- **data_unit_manager.py**: æ•°æ®å•å…ƒç®¡ç†å™¨
- **runner_manager.py**: è¿è¡Œå™¨ç®¡ç†å™¨

### 2. ç¯å¢ƒç³»ç»Ÿ (Environment)

ç¯å¢ƒç³»ç»Ÿæä¾›ç»Ÿä¸€çš„æ¥å£æ¥é›†æˆå¤šç§å¼ºåŒ–å­¦ä¹ ç¯å¢ƒã€‚

#### æ ¸å¿ƒç»„ä»¶ï¼š
- **base_env.py** (`/AquaML/environment/base_env.py`): ç¯å¢ƒåŸºç±»ï¼Œå®šä¹‰å­—å…¸å¼æ•°æ®æ¥å£
- **gymnasium_envs.py** (`/AquaML/environment/gymnasium_envs.py`): Gymnasiumç¯å¢ƒç›´æ¥å°è£…
- **gymnasium_vector_envs.py** (`/AquaML/environment/gymnasium_vector_envs.py`): Gymnasiumå‘é‡ç¯å¢ƒæ”¯æŒ
- **virtual_env.py** (`/AquaML/environment/virtual_env.py`): è™šæ‹Ÿç¯å¢ƒå®ç°

#### ç¯å¢ƒåŒ…è£…å™¨ (Wrappers):
- **base.py** (`/AquaML/environment/wrappers/base.py`): åŒ…è£…å™¨åŸºç±»
- **gymnasium_envs.py** (`/AquaML/environment/wrappers/gymnasium_envs.py`): Gymnasiumé€‚é…å™¨
- **isaaclab_envs.py** (`/AquaML/environment/wrappers/isaaclab_envs.py`): Isaac Labç¯å¢ƒé€‚é…
- **brax_envs.py** (`/AquaML/environment/wrappers/brax_envs.py`): Braxç‰©ç†ä»¿çœŸç¯å¢ƒé€‚é…
- **utils.py** (`/AquaML/environment/wrappers/utils.py`): åŒ…è£…å™¨å·¥å…·å‡½æ•°

#### æ”¯æŒçš„ç¯å¢ƒç±»å‹ï¼š
| ç¯å¢ƒç±»å‹ | å•æ™ºèƒ½ä½“ | å¤šæ™ºèƒ½ä½“ | ç‰¹æ®ŠåŠŸèƒ½ |
|---------|---------|---------|---------|
| Gymnasium | âœ… | âœ… | é¢„é…ç½®ç¯å¢ƒï¼Œå‘é‡åŒ–æ”¯æŒ |
| Isaac Lab | âœ… | âœ… | Policy/Criticåˆ†ç¦» |
| Brax | âœ… | âŒ | ç‰©ç†ä»¿çœŸç‰¹æ€§ |
| PettingZoo | ğŸ”„ | ğŸ”„ | æ ‡å‡†å¤šæ™ºèƒ½ä½“ï¼ˆè§„åˆ’ä¸­ï¼‰ |

### 3. å­¦ä¹ ç³»ç»Ÿ (Learning)

å­¦ä¹ ç³»ç»ŸåŒ…å«æ¨¡å‹ã€å¼ºåŒ–å­¦ä¹ ç®—æ³•å’Œè®­ç»ƒå™¨ä¸‰ä¸ªå­ç³»ç»Ÿã€‚

#### æ¨¡å‹ç³»ç»Ÿ (Model):
- **base.py** (`/AquaML/learning/model/base.py`): æ¨¡å‹åŸºç±»ï¼Œæ”¯æŒå­—å…¸å¼è¾“å…¥è¾“å‡º
- **gaussian.py** (`/AquaML/learning/model/gaussian.py`): é«˜æ–¯ç­–ç•¥æ¨¡å‹
- **model_cfg.py** (`/AquaML/learning/model/model_cfg.py`): æ¨¡å‹é…ç½®ç±»

#### å¼ºåŒ–å­¦ä¹ ç®—æ³• (Reinforcement):
- **base.py** (`/AquaML/learning/reinforcement/base.py`): æ™ºèƒ½ä½“åŸºç±»
- **on_policy/** (`/AquaML/learning/reinforcement/on_policy/`): åœ¨ç­–ç•¥ç®—æ³•ç›®å½•
  - **ppo.py**: PPOç®—æ³•å®ç°
- **off_policy/** (`/AquaML/learning/reinforcement/off_policy/`): ç¦»ç­–ç•¥ç®—æ³•ç›®å½•ï¼ˆé¢„ç•™æ‰©å±•ï¼‰

#### PPOç®—æ³•ç‰¹æ€§ï¼š
- âœ… ä¿®å¤GAEè®¡ç®—æ—¶æœº
- âœ… KLæ•£åº¦è‡ªé€‚åº”å­¦ä¹ ç‡è°ƒåº¦
- âœ… é¢„å¤„ç†å™¨æ”¯æŒ(çŠ¶æ€/å€¼æ ‡å‡†åŒ–)
- âœ… å¢å¼ºçš„æ•°æ®æ”¶é›†å’Œæ‰¹å¤„ç†
- âœ… è¯¦ç»†çš„è®­ç»ƒç›‘æ§å’Œæ—¥å¿—

#### è®­ç»ƒå™¨ç³»ç»Ÿ (Trainers):
- **base.py** (`/AquaML/learning/trainers/base.py`): è®­ç»ƒå™¨åŸºç±»
- **sequential.py** (`/AquaML/learning/trainers/sequential.py`): é¡ºåºè®­ç»ƒå™¨å®ç°

#### æ‰©å±•æ¨¡å—:
- **learning/base.py** (`/AquaML/learning/base.py`): å­¦ä¹ ç³»ç»ŸåŸºç¡€ç±»
- **teacher_student/** (`/AquaML/learning/teacher_student/`): å¸ˆç”Ÿå­¦ä¹ æ¡†æ¶ï¼ˆæ‰©å±•åŠŸèƒ½ï¼‰

### 4. æ•°æ®å¤„ç†ç³»ç»Ÿ (Data)

æ•°æ®å¤„ç†ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„æ•°æ®æ ¼å¼å’Œå¤„ç†æµç¨‹ã€‚

#### æ ¸å¿ƒç»„ä»¶ï¼š
- **base_unit.py** (`/AquaML/data/base_unit.py`): æ•°æ®å•å…ƒåŸºç±»
- **tensor_unit.py** (`/AquaML/data/tensor_unit.py`): PyTorchå¼ é‡æ•°æ®å•å…ƒ
- **numpy_unit.py** (`/AquaML/data/numpy_unit.py`): NumPyæ•°ç»„æ•°æ®å•å…ƒ
- **cfg_status.py** (`/AquaML/data/cfg_status.py`): é…ç½®çŠ¶æ€ç®¡ç†

#### æ•°æ®æ ¼å¼è§„èŒƒï¼š
- æ‰€æœ‰æ•°æ®å½¢çŠ¶è§„èŒƒä¸º: `(num_machines, num_envs, feature_dim)`
- æ”¯æŒå­—å…¸å¼æ•°æ®ç»“æ„
- è‡ªåŠ¨ç±»å‹è½¬æ¢å’Œè®¾å¤‡ç®¡ç†

### 5. é…ç½®ç³»ç»Ÿ (Config)

é…ç½®ç³»ç»Ÿæä¾›çµæ´»çš„å‚æ•°ç®¡ç†å’Œé…ç½®éªŒè¯ã€‚

#### æ ¸å¿ƒç»„ä»¶ï¼š
- **configclass.py** (`/AquaML/config/configclass.py`): é…ç½®ç±»è£…é¥°å™¨
- **manager.py** (`/AquaML/config/manager.py`): é…ç½®ç®¡ç†å™¨
- **defaults/**: é»˜è®¤é…ç½®æ–‡ä»¶å¤¹
- **schemas/**: é…ç½®æ¶æ„éªŒè¯

### 6. å·¥å…·æ¨¡å— (Utils)

å·¥å…·æ¨¡å—æä¾›å„ç§è¾…åŠ©åŠŸèƒ½å’Œå®ç”¨ç¨‹åºã€‚

#### æ ¸å¿ƒå·¥å…·ï¼š
- **preprocessors.py** (`/AquaML/utils/preprocessors.py`): çŠ¶æ€å’Œå€¼é¢„å¤„ç†å™¨
- **schedulers.py** (`/AquaML/utils/schedulers.py`): å­¦ä¹ ç‡è°ƒåº¦å™¨
- **tensorboard_manager.py** (`/AquaML/utils/tensorboard_manager.py`): TensorBoardé›†æˆ
- **file_system/**: æ–‡ä»¶ç³»ç»Ÿå·¥å…·å’Œå®éªŒç®¡ç†
- **array.py** (`/AquaML/utils/array.py`): æ•°ç»„æ“ä½œå·¥å…·
- **dict.py** (`/AquaML/utils/dict.py`): å­—å…¸æ“ä½œå·¥å…·
- **string.py** (`/AquaML/utils/string.py`): å­—ç¬¦ä¸²å¤„ç†å·¥å…·
- **tool.py** (`/AquaML/utils/tool.py`): é€šç”¨å·¥å…·å‡½æ•°
- **collector/**: æ•°æ®æ”¶é›†å™¨æ¨¡å—

## æ¶æ„ç‰¹ç‚¹

### 1. å­—å…¸å¼æ•°æ®æ¶æ„
- åŸç”Ÿæ”¯æŒå¤æ‚çš„è§‚å¯Ÿå’ŒåŠ¨ä½œç©ºé—´
- ç»Ÿä¸€çš„æ•°æ®æ ¼å¼å¤„ç†ä¸åŒç¯å¢ƒ
- çµæ´»çš„æ•°æ®é”®å€¼å¯¹ç®¡ç†

### 2. æ¨¡å—åŒ–è®¾è®¡
- ç¯å¢ƒã€æ™ºèƒ½ä½“ã€è®­ç»ƒå™¨ç›¸äº’ç‹¬ç«‹
- æ˜“äºæ‰©å±•å’Œè‡ªå®šä¹‰
- æ¸…æ™°çš„æ¥å£å®šä¹‰

### 3. åè°ƒå™¨æ¨¡å¼
- ç»Ÿä¸€çš„ç»„ä»¶ç®¡ç†å’Œè®¾å¤‡ç®¡ç†
- æ™ºèƒ½çš„CPU/GPUè®¾å¤‡é€‰æ‹©
- å…¨å±€èµ„æºåè°ƒ

### 4. ç¯å¢ƒå…¼å®¹æ€§
- æ”¯æŒå¤šç§ä¸»æµå¼ºåŒ–å­¦ä¹ ç¯å¢ƒ
- è‡ªåŠ¨ç¯å¢ƒç±»å‹æ£€æµ‹å’ŒåŒ…è£…
- é«˜æ€§èƒ½æ•°æ®è½¬æ¢ (< 1ms per step)

## æ ¸å¿ƒå·¥ä½œæµç¨‹

### 1. ç¯å¢ƒåˆå§‹åŒ–
```python
env = GymnasiumWrapper("Pendulum-v1")
```

### 2. æ¨¡å‹åˆ›å»º
```python
policy = PendulumPolicy(model_cfg)
value = PendulumValue(model_cfg)
models = {"policy": policy, "value": value}
```

### 3. æ™ºèƒ½ä½“é…ç½®
```python
ppo_cfg = PPOCfg()
agent = PPO(models, ppo_cfg)
```

### 4. è®­ç»ƒæ‰§è¡Œ
```python
trainer_cfg = TrainerConfig(timesteps=10000)
trainer = SequentialTrainer(env, agent, trainer_cfg)
trainer.train()
```

### 5. æ¨¡å‹ç®¡ç†
```python
agent.save("./trained_model.pt")
agent.load("./trained_model.pt")
```

## æ€§èƒ½ç‰¹ç‚¹

- **é«˜æ€§èƒ½**: æ•°æ®è½¬æ¢å¼€é”€ < 1ms per step
- **å†…å­˜é«˜æ•ˆ**: æ™ºèƒ½çš„æ‰¹å¤„ç†å’Œå†…å­˜ç®¡ç†
- **è®¾å¤‡ä¼˜åŒ–**: è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜è®¡ç®—è®¾å¤‡
- **å¹¶è¡Œæ”¯æŒ**: å¤šç¯å¢ƒå¹¶è¡Œè®­ç»ƒ

## æ‰©å±•æ€§

AquaMLæ¡†æ¶è®¾è®¡æ—¶å……åˆ†è€ƒè™‘äº†æ‰©å±•æ€§ï¼š

1. **è‡ªå®šä¹‰ç¯å¢ƒ**: ç»§æ‰¿BaseEnvå®ç°æ–°ç¯å¢ƒ
2. **è‡ªå®šä¹‰ç®—æ³•**: ç»§æ‰¿AgentåŸºç±»å®ç°æ–°ç®—æ³•
3. **è‡ªå®šä¹‰æ¨¡å‹**: ç»§æ‰¿ModelåŸºç±»å®ç°æ–°ç½‘ç»œç»“æ„
4. **è‡ªå®šä¹‰è®­ç»ƒå™¨**: ç»§æ‰¿BaseTrainerå®ç°æ–°è®­ç»ƒæµç¨‹

## ä¸å…¶ä»–æ¡†æ¶çš„æ¯”è¾ƒ

### ä¸SKRLçš„ç›¸ä¼¼æ€§ï¼š
- ç®€å•çš„APIè®¾è®¡
- çµæ´»çš„é…ç½®ç®¡ç†
- æ¨¡å—åŒ–æ¶æ„

### AquaMLçš„ç‹¬ç‰¹ä¼˜åŠ¿ï¼š
- å­—å…¸å¼æ•°æ®æ¶æ„
- åè°ƒå™¨ç»Ÿä¸€ç®¡ç†
- æœºå™¨äººå­¦ä¹ ä¼˜åŒ–
- æ›´å¹¿æ³›çš„ç¯å¢ƒæ”¯æŒ

## æ–‡ä»¶ç»“æ„æ˜ å°„

```
AquaML/
â”œâ”€â”€ core/                    # åè°ƒå™¨ç³»ç»Ÿ
â”‚   â”œâ”€â”€ coordinator.py       # ä¸»åè°ƒå™¨
â”‚   â”œâ”€â”€ coordinator_backup.py # åè°ƒå™¨å¤‡ä»½
â”‚   â”œâ”€â”€ device_info.py       # è®¾å¤‡ç®¡ç†
â”‚   â”œâ”€â”€ registry.py          # ç»„ä»¶æ³¨å†Œ
â”‚   â”œâ”€â”€ tensor_tool.py       # å¼ é‡å·¥å…·
â”‚   â”œâ”€â”€ exceptions.py        # å¼‚å¸¸å®šä¹‰
â”‚   â”œâ”€â”€ lifecycle.py         # ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â””â”€â”€ managers/            # å„ç±»ç®¡ç†å™¨
â”‚       â”œâ”€â”€ agent_manager.py
â”‚       â”œâ”€â”€ model_manager.py
â”‚       â”œâ”€â”€ environment_manager.py
â”‚       â”œâ”€â”€ data_manager.py
â”‚       â”œâ”€â”€ file_system_manager.py
â”‚       â”œâ”€â”€ communicator_manager.py
â”‚       â”œâ”€â”€ data_unit_manager.py
â”‚       â””â”€â”€ runner_manager.py
â”œâ”€â”€ environment/             # ç¯å¢ƒç³»ç»Ÿ
â”‚   â”œâ”€â”€ base_env.py          # ç¯å¢ƒåŸºç±»
â”‚   â”œâ”€â”€ gymnasium_envs.py    # Gymnasiumç¯å¢ƒ
â”‚   â”œâ”€â”€ gymnasium_vector_envs.py # å‘é‡ç¯å¢ƒ
â”‚   â”œâ”€â”€ virtual_env.py       # è™šæ‹Ÿç¯å¢ƒ
â”‚   â””â”€â”€ wrappers/            # ç¯å¢ƒåŒ…è£…å™¨
â”‚       â”œâ”€â”€ base.py
â”‚       â”œâ”€â”€ gymnasium_envs.py
â”‚       â”œâ”€â”€ isaaclab_envs.py
â”‚       â”œâ”€â”€ brax_envs.py
â”‚       â””â”€â”€ utils.py
â”œâ”€â”€ learning/                # å­¦ä¹ ç³»ç»Ÿ
â”‚   â”œâ”€â”€ base.py              # å­¦ä¹ åŸºç±»
â”‚   â”œâ”€â”€ model/               # æ¨¡å‹ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ gaussian.py
â”‚   â”‚   â””â”€â”€ model_cfg.py
â”‚   â”œâ”€â”€ reinforcement/       # å¼ºåŒ–å­¦ä¹ ç®—æ³•
â”‚   â”‚   â”œâ”€â”€ base.py          # æ™ºèƒ½ä½“åŸºç±»
â”‚   â”‚   â”œâ”€â”€ on_policy/       # åœ¨ç­–ç•¥ç®—æ³•
â”‚   â”‚   â”‚   â””â”€â”€ ppo.py       # PPOç®—æ³•å®ç°
â”‚   â”‚   â””â”€â”€ off_policy/      # ç¦»ç­–ç•¥ç®—æ³•ï¼ˆé¢„ç•™æ‰©å±•ï¼‰
â”‚   â”œâ”€â”€ trainers/            # è®­ç»ƒå™¨ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â””â”€â”€ sequential.py
â”‚   â””â”€â”€ teacher_student/     # å¸ˆç”Ÿå­¦ä¹ æ¡†æ¶
â”œâ”€â”€ data/                    # æ•°æ®å¤„ç†ç³»ç»Ÿ
â”‚   â”œâ”€â”€ base_unit.py
â”‚   â”œâ”€â”€ tensor_unit.py
â”‚   â”œâ”€â”€ numpy_unit.py
â”‚   â””â”€â”€ cfg_status.py
â”œâ”€â”€ config/                  # é…ç½®ç³»ç»Ÿ
â”‚   â”œâ”€â”€ configclass.py
â”‚   â”œâ”€â”€ manager.py
â”‚   â”œâ”€â”€ defaults/
â”‚   â””â”€â”€ schemas/
â”œâ”€â”€ utils/                   # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ preprocessors.py
â”‚   â”œâ”€â”€ schedulers.py
â”‚   â”œâ”€â”€ tensorboard_manager.py
â”‚   â”œâ”€â”€ array.py
â”‚   â”œâ”€â”€ dict.py
â”‚   â”œâ”€â”€ string.py
â”‚   â”œâ”€â”€ tool.py
â”‚   â”œâ”€â”€ collector/
â”‚   â”‚   â””â”€â”€ concat.py
â”‚   â””â”€â”€ file_system/
â”‚       â”œâ”€â”€ base_file_system.py
â”‚       â”œâ”€â”€ default_file_system.py
â”‚       â””â”€â”€ experiment_utils.py
â”œâ”€â”€ plugin/                  # æ’ä»¶ç³»ç»Ÿ
â””â”€â”€ enum.py                  # æšä¸¾å®šä¹‰
```

è¿™ä¸ªæ¶æ„è®¾è®¡ä½¿å¾—AquaMLæ—¢ä¿æŒäº†ç®€å•æ˜“ç”¨çš„APIï¼Œåˆå…·å¤‡äº†å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›å’Œç¯å¢ƒå…¼å®¹æ€§ï¼Œç‰¹åˆ«é€‚åˆæœºå™¨äººå­¦ä¹ ä»»åŠ¡çš„éœ€æ±‚ã€‚